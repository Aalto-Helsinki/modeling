% Data creation of sensitivity plot
AcetoacetylCoA= [-0.311208	-0.311208	1.02664	0.00995074	6.87549e-05	-0.0270244	3.79307e-05	2.18322e-06	5.14777e-07	-6.03536e-08	6.25253e-07	1.82261e-07	9.39813e-10	8.91643e-07	2.99131e-07	5.84103e-10	5.09095e-10	-2.3052e-12	3.34254e-10	5.1406e-10	2.41405e-06	2.13389e-06	6.28139e-07	2.17677e-06];
HydroxybutyrylCoA	= [-0.00024362	-0.00024362	0.000788799	-0.450012	-0.000496963	1.2222	-0.000309341	0.999995	-1.22051	-2.51989e-06	-2.47069e-05	-4.73346e-06	1.04448e-08	-1.38555e-05	-2.74058e-05	9.06255e-09	-7.1734e-09	-4.81089e-10	7.21396e-08	-5.2759e-09	-2.53974e-05	2.19843e-06	-1.91702e-05	-8.16686e-06];
CrotonylCoA=[-0.000226421	-0.000226421	0.000733638	-0.418454	-0.000462033	1.13636	-0.000287676	-4.7134e-06	-1.31786e-05	0.0126043	0.995403	-1.13497	0.00457337	-1.2933e-05	-2.56778e-05	7.47044e-09	-7.71262e-09	-4.49502e-10	6.74595e-08	-5.92511e-09	-2.37779e-05	2.20144e-06	-1.77891e-05	-7.49908e-06];
ButyrylCoA=[-0.000237238	-0.000237238	0.000769812	-0.438862	-0.00048443	1.19186	-0.000301785	-4.61056e-06	-1.41536e-05	-2.05798e-06	-2.49209e-05	-4.89621e-06	1.96033e-09	0.999986	-1.1903	5.65943e-09	-1.044e-08	-4.78957e-10	7.15488e-08	-8.51407e-09	-2.5287e-05	2.64989e-06	-1.85784e-05	-7.66281e-06];
Butyrate=[	-0.00121293	-0.00121293	0.00383757	-0.369456	-0.00250015	1.00337	-0.00138529	-0.00773159	0.00933001	2.28529e-06	-0.000178929	0.000173434	-7.60593e-07	-0.000337196	0.00035878	1.46963e-05	0.00150158	4.45307e-05	0.0367576	-0.0420516	-0.006229	0.00606932	0.00612306	-0.00621819];
Butyraldehyde=[-0.00193409	-0.00193409	0.00594976	-0.322008	-0.00397666	0.874603	-0.00204726	-0.0146778	0.0175144	-4.85907e-05	-0.000402497	0.000366732	-1.55582e-06	-0.000719889	0.000625197	-0.000341425	-0.034831	-0.00103293	-0.852625	0.975425	0.142313	-0.14271	-0.142593	0.142273];

M = [AcetoacetylCoA;HydroxybutyrylCoA;CrotonylCoA;ButyrylCoA;Butyrate;Butyraldehyde];

% taking away the unnecessary stuff

% car activation
M = M(:,1:20);

% Plot of relative sensitivities

figure
b = bar3(M);
colormap('jet')
%colorbar
for k = 1:length(b)
    zdata = b(k).ZData;
    b(k).CData = zdata;
    b(k).FaceColor = 'interp';
end

hh = get(b(3),'parent');

str = {'Acetoacetyl-CoA'; '3-hydr.-CoA'; 'Crotonyl-CoA'; 'Butyryl-Coa'; 'Butyric acid'; 'Butyraldehyde'; 'Propane'};
str2 = {'(AtoB).Kmb';	'(AtoB).Kma';	'(AtoB).Kcat';	'(Hdb).Kmb';	'(Hdb).Kma';	'(Hdb).Kcat';	'(Hdb).Kia';	'(Crt).Km';	'(Crt).Kcat';	'(Ter).Kmb';	'(Ter).Kma';	'(Ter).Kcat';	'(Ter).Kia';	'(YciA).Km';	'(YciA).Kcat';	'(Car).Kia';	'(Car).Kmb';	'(Car).Kmc';	'(Car).Kma';	'(Car).Kcat'};
set(gca,'XTickLabel',str2, 'XTick',1:numel(str2));
set(gca,'YTickLabel',str, 'YTick',1:numel(str));
